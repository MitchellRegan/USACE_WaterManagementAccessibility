<!DOCTYPE html>
<html lang="en">

    <head>
        <!-- Meta -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <title>Create Event | USACE</title>
        <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico">

        <!-- PWA App Manifest File -->
        <link rel="manifest" href="./json/manifest.json">

        <!-- CSS -->
        <link rel="stylesheet" href="css/styles.css">
        <link rel="stylesheet" href="css/a2w.public.min.css" media="screen">

        <!-- JS -->
        <script defer type="text/javascript" src="./js/create_database_event.js"></script>
        <script defer type="text/javascript" src="./js/common.js"></script>

        <!-- Firebase OAuth CDN -->
        <!-- Reference: https://github.com/firebase/firebaseui-web -->
        <script src="https://www.gstatic.com/firebasejs/9.13.0/firebase-app-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/9.13.0/firebase-auth-compat.js"></script>
        <script type="text/javascript">
            initApp = function () {
                const firebaseConfig = {
                    apiKey: "AIzaSyAr7SQASmasb7pk7E3OHhuewJoY76CcJ30",
                    authDomain: "mregan-capstone.firebaseapp.com",
                    databaseURL: "https://mregan-capstone-default-rtdb.firebaseio.com",
                    projectId: "mregan-capstone",
                    storageBucket: "mregan-capstone.appspot.com",
                    messagingSenderId: "736102415357",
                    appId: "1:736102415357:web:06211517f034486cc37794"
                };
                const app = firebase.initializeApp(firebaseConfig);
                firebase.auth().onAuthStateChanged(function (user) {
                    if (user) {
                        // User is signed in.
                        var displayName = user.displayName;
                        var email = user.email;
                        var emailVerified = user.emailVerified;
                        var photoURL = user.photoURL;
                        var uid = user.uid;
                        var phoneNumber = user.phoneNumber;
                        var providerData = user.providerData;
                        var token = undefined;
                        user.getIdToken()
                            .then(t => { token = t; })

                        document.getElementById("email").value = user.email;
                        document.getElementById('signedIn').style.display = 'visible';
                        document.getElementById('signedOut').style.display = 'none';

                        //Only allowing USACE members to access this page
                        if (email.split('@')[0] == 'usace.army.mil') {
                            document.getElementById('invalidUser').style.display = 'visible';
                        }
                    } else {
                        // User is signed out.
                        document.getElementById('signedIn').style.display = 'none';
                        document.getElementById('signedOut').style.display = 'visible';
                        document.getElementById('invalidUser').style.display = 'none';
                    }
                }, function (error) {
                    console.log(error);
                });
            };

            window.addEventListener('load', function () {
                initApp()
            });

            logUserOut = function () {
                firebase.auth().signOut().then(() => {
                    console.log("signing out...");
                    window.location.href = './usace_login.html';
                });
            };
        </script>
    </head>

    <body class="" style="padding-top:85px; overflow:auto">
        <header>
            <nav id="main-navigation" class="navbar navbar-default navbar-fixed-top banner" role="navigation">
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="container-fluid" style="padding: 0 15px;">
                    <div class="navbar-header">
                        <a class="navbar-brand home-nav" id="nav-home" style="width: auto">
                            <div class="logo_content" style="width: 100%">
                                <div class="USACE_logo hidden-xs">
                                    <img src="https://water.usace.army.mil/a2w_files/production/images/USACE_logo.png"
                                        alt="United States Army Corps of Engineers logo" width="72" height="49">
                                </div>
                                <div class="USACE_logo visible-xs">
                                    <img src="https://water.usace.army.mil/a2w_files/production/images/USACE_logo.png"
                                        alt="United States Army Corps of Engineers logo" width="58" height="40">
                                </div>
                                <div class="pull-right">
                                    <div class="main_title visible-xs-inline visible-sm-inline hidden-md hidden-lg"
                                        title="Access to Water Resources Data">A2W</div>
                                    <div class="main_title hidden-xs hidden-sm">Access to Water Resources Data</div>
                                    <div class="secondary_title visible-xs-block visible-sm-block hidden-md hidden-lg"
                                        style="font-size: 18px; color: #ccc;" title="WM Data Dissemination">WM &amp; WQ
                                    </div>
                                    <div class="secondary_title hidden-xs hidden-sm"
                                        style="font-size: 18px; color: #ccc;">WM Data Dissemination</div>
                                </div>
                            </div>
                        </a>
                        <button type="button" class="navbar-toggle collapsed pull-right" data-toggle="collapse"
                            data-target="#navButtonia" aria-expanded="false">
                            <span class="sr-only">Toggle navigation</span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                            <span class="icon-bar"></span>
                        </button>
                    </div>

                    <div class="collapse navbar-collapse" id="navButtonia">
                        <ul class="nav navbar-nav navbar-right navbar-icons pull-right">
                            <li class="navbar-icon map-nav" id="nav-map" title="Map">
                                <a href="https://water.usace.army.mil/a2w/f?p=100:1#" class="ladda-button"
                                    data-style="expand-right" data-size="l" data-spinner-size="16"
                                    data-spinner-color="#000000" data-toggle="collapse" data-target="#navButtonia">
                                    <span class="ladda-label">
                                        <i alt="Map" class="fa fa-map-marker"></i>
                                        <span> Map</span>
                                    </span>
                                    <span class="ladda-spinner"></span>
                                </a>
                            </li>
                            <li class="navbar-icon reporting-nav" id="nav-reporting" title="Overview">
                                <a href="https://water.usace.army.mil/a2w/f?p=100:1#" class="ladda-button"
                                    data-style="expand-right" data-size="l" data-spinner-size="16"
                                    data-spinner-color="#000000" data-toggle="collapse" data-target="#navButtonia">
                                    <span class="ladda-label">
                                        <i alt="Overview" class="fa fa-list fa-flip-horizontal"></i>
                                        <span> Overview</span>
                                    </span>
                                </a>
                            </li>
                            <li class="navbar-icon reporting-nav" id="nav-reporting" title="Overview">
                                <a href="./index.html" class="ladda-button" data-style="expand-right" data-size="l"
                                    data-spinner-size="16" data-spinner-color="#000000" data-toggle="collapse"
                                    data-target="#navButtonia">
                                    <span class="ladda-label">
                                        <i alt="Overview" class="fa fa-list fa-flip-horizontal"></i>
                                        <span> Site Search</span>
                                    </span>
                                </a>
                            </li>
                            <li class="navbar-icon reporting-nav" id="nav-reporting" title="Overview">
                                <a href="./usace_login.html" class="ladda-button" data-style="expand-right"
                                    data-size="l" data-spinner-size="16" data-spinner-color="#000000"
                                    data-toggle="collapse" data-target="#navButtonia">
                                    <span class="ladda-label">
                                        <i alt="Overview" class="fa fa-list fa-flip-horizontal"></i>
                                        <span> Create Event</span>
                                    </span>
                                </a>
                            </li>
                            <li class="navbar-icon" title="Help">
                                <a href="" id="helpButton" data-toggle="modal" data-target="#helpDialog" title="Help">
                                    <span alt="Help" class="fa fa-question-circle"></span>
                                    <span> Help</span>
                                </a>
                            </li>
                        </ul>
                    </div>
                </div>
            </nav>
        </header>

        <div style="margin-left:auto; margin-right:auto; text-align:center; min-width: 400px;">
            <h1>New Historical Event</h1>
            <p>This page is for creating a new historical event to show up on the water data graphs. Click <a
                    onclick="logUserOut()">here</a> to sign out.</p>

            <div id="signedOut">
                <p>You are not signed in. Please click <a href="./usace_login.html">here</a> to sign-in to your
                    U.S.A.C.E. account in order to access this page.</p>
            </div>

            <div id="invalidUser">
                <i class="requiredText">You are not signed in as a member of the USACE. Any entered data will not be
                    saved.</i>
            </div>
        </div>

        <div id="signedIn main" style="margin-left:auto; margin-right:auto; min-width: 400px;">
            <form id="evtForm"
                style="display:flex; flex-direction:row; justify-content:center; margin-left:auto; margin-right:auto;">
                <div id="leftForm">
                    <label for="email">Signed in as:</label><br>
                    <input type="text" id="email" style="width:100%;" readonly=false><br><br>

                    <label for="evtTitle">Event Title<i class="requiredText">*</i>:</label><br>
                    <input type="text" id="evtTitle" name="evtTitle" style="width:100%" required=True><br><br>

                    <label for="evtDesc">Event Description<i class="requiredText">*</i>:</label><br>
                    <textarea id="evtDesc" name="evtDesc" required=True form="evtForm" rows=4 cols=40
                        style="width:100%"></textarea><br><br>

                    <label for="evtImg">Image URL:</label><br>
                    <input type="url" id="evtImg" name="evtImg" style="width:100%"><br><br>

                    <label for="evtStart">Start Date<i class="requiredText">*</i>:</label>
                    <input type="datetime-local" id="evtStart" name="evtStart" required=True><br>
                    <label for="evtEnd">End Date<i class="requiredText">*</i>: </label>
                    <input type="datetime-local" id="evtEnd" name="evtEnd" required=True><br>

                    <!-- Taken from https://gist.github.com/nodesocket/3919205 -->
                    <label for="evtTZ">Timezone:</label>
                    <select name="evtTZ" id="evtTZ">
                        <option value=-12>(GMT -12:00) Eniwetok, Kwajalein</option>
                        <option value=-11>(GMT -11:00) Midway Island, Samoa</option>
                        <option value=-10>(GMT -10:00) Hawaii</option>
                        <option value=-9.5>(GMT -9:30) Taiohae</option>
                        <option value=-9>(GMT -9:00) Alaska</option>
                        <option value=-8>(GMT -8:00) Pacific Time (US &amp; Canada)</option>
                        <option value=-7>(GMT -7:00) Mountain Time (US &amp; Canada)</option>
                        <option value=-6 selected="selected">(GMT -6:00) Central Time (US &amp; Canada)</option>
                        <option value=-5>(GMT -5:00) Eastern Time (US &amp; Canada)</option>
                        <option value=-4.5>(GMT -4:30) Caracas</option>
                        <option value=-4>(GMT -4:00) Atlantic Time (Canada)</option>
                        <option value=-3.5>(GMT -3:30) Newfoundland</option>
                        <option value=-3>(GMT -3:00) Brazil, Buenos Aires</option>
                        <option value=-2>(GMT -2:00) Mid-Atlantic</option>
                        <option value=-1>(GMT -1:00) Cape Verde Islands</option>
                        <option value=0>(GMT) Western Europe Time</option>
                        <option value=1>(GMT +1:00) Brussels, Madrid, Paris</option>
                        <option value=2>(GMT +2:00) Kaliningrad, South Africa</option>
                        <option value=3>(GMT +3:00) Baghdad, Riyadh, Moscow</option>
                        <option value=3.5>(GMT +3:30) Tehran</option>
                        <option value=4>(GMT +4:00) Abu Dhabi, Muscat, Baku, Tbilisi</option>
                        <option value=4.5>(GMT +4:30) Kabul</option>
                        <option value=5>(GMT +5:00) Islamabad, Karachi</option>
                        <option value=5.5>(GMT +5:30) Bombay, Calcutta, New Delhi</option>
                        <option value=5.75>(GMT +5:45) Kathmandu, Pokhara</option>
                        <option value=6>(GMT +6:00) Almaty, Dhaka, Colombo</option>
                        <option value=6.5>(GMT +6:30) Yangon, Mandalay</option>
                        <option value=7>(GMT +7:00) Bangkok, Hanoi, Jakarta</option>
                        <option value=8>(GMT +8:00) Beijing, Singapore, Hong Kong</option>
                        <option value=8.75>(GMT +8:45) Eucla</option>
                        <option value=9>(GMT +9:00) Tokyo, Seoul, Osaka</option>
                        <option value=9.5>(GMT +9:30) Adelaide, Darwin</option>
                        <option value=10>(GMT +10:00) Eastern Australia, Guam</option>
                        <option value=10.5>(GMT +10:30) Lord Howe Island</option>
                        <option value=11>(GMT +11:00) Magadan, Solomon Islands</option>
                        <option value=11.5>(GMT +11:30) Norfolk Island</option>
                        <option value=12>(GMT +12:00) Auckland, Fiji</option>
                        <option value=12.75>(GMT +12:45) Chatham Islands</option>
                        <option value=13>(GMT +13:00) Apia, Nukualofa</option>
                        <option value=14>(GMT +14:00) Line Islands</option>
                    </select><br><br>
                    <!--input type="submit" value="Submit" onPress="writeDatabaseEvt($('#evtTitle').value, $('#evtDesc').value, $('#evtStart').value, $('#evtEnd').value, $('#evtImg').value)"-->
                </div>

                <div id="rightForm">
                    <label for="nameSearch">Affected Water Sites<i class="requiredText">*</i>:</label>
                    <div id="" class="fade collapse in">
                        <label for="nameSearch">Search:</label>
                        <input id="nameSearch" type="text" onkeyup="search()" placeholder="Site Name" />
                        <label for="citySearch" style="display:none;">City:</label>
                        <input id="citySearch" type="text" onkeyup="search()" placeholder="City Name"
                            style="display:none;" />
                        <label for="countySearch" style="display:none;">County:</label>
                        <input id="countySearch" type="text" onkeyup="search()" placeholder="County Name"
                            style="display:none;" />
                        <button type="button" onclick="addSiteToList()">Add To List</button>
                        <div id="searchResults" class="listContainer"></div>
                    </div>
                    <p id="invalidSiteName" style="text-align: center; display:none;"><i class="requiredText"
                            style="margin:auto">Please enter a valid location name</i></p>
                    <ul id="addedSites"></ul>
                </div>
            </form>
            <div id="bottomForm">
                <button type="submit"
                    onclick="writeDatabaseEvt(document.getElementById('email').value, document.getElementById('evtTitle').value, document.getElementById('evtDesc').value, document.getElementById('evtStart').value, document.getElementById('evtEnd').value, document.getElementById('evtTZ').value, document.getElementById('evtImg').value)"
                    style="margin-left:auto; margin-right:auto;">Submit</button>
                <p style="margin-left:auto; margin-right:auto;"><i class="requiredText" style="margin:auto">*</i>
                    indicates required fields</p>
            </div>
            <!--button onclick="testWriteDb(document.getElementById('evtDesc').value)">TEST</button-->
        </div>

        <section class="container-fluid footer">
            <div class="row-fluid footer_links">
                <div class="col-md-1"><a id="aboutFooter" class="footer_link"
                        style="color: white; cursor: pointer;">About Us</a></div>
                <div class="col-md-1"><a id="legalFooter" class="footer_link"
                        style="color: white; cursor: pointer;">Legal</a></div>
                <div class="col-md-1"><a target="_blank" style="color: white; cursor: pointer;"
                        href="http://www.usace.army.mil/Accessibility.aspx">Accessibility</a></div>
                <div class="col-md-1"><a style="color: white; cursor: pointer;"
                        href="mailto:water@usace.army.mil">Contact Us</a></div>
                <div class="col-md-1"><a target="_blank" style="color: white; cursor: pointer;"
                        href="http://www.usace.army.mil/FOIA.aspx">FOIA</a></div>
                <div class="col-md-1"><a target="_blank" style="color: white; cursor: pointer;"
                        href="http://www.usace.army.mil/InformationQualityAct.aspx">Information Quality Act</a></div>
                <div class="col-md-1"><a target="_blank" style="color: white; cursor: pointer;"
                        href="http://www.usace.army.mil/LinkDisclaimer.aspx">Link Disclaimer</a></div>
                <div class="col-md-1"><a target="_blank" style="color: white; cursor: pointer;"
                        href="http://prhome.defense.gov/nofear">No Fear Act</a></div>
                <div class="col-md-1"><a target="_blank" style="color: white; cursor: pointer;"
                        href="http://www.usace.army.mil/PrivacyandSecurity.aspx">Privacy &amp; Security</a></div>
                <div class="col-md-1"><a style="color: white; cursor: pointer;"
                        href="mailto:Bryan.R.Armbrust@usace.army.mil">Public Inquiries</a></div>
                <div class="col-md-1"><a target="_blank" style="color: white; cursor: pointer;"
                        href="http://www.usace.army.mil/SiteMap.aspx">Site Map</a></div>
                <div class="col-md-1"><a target="_blank" style="color: white; cursor: pointer;"
                        href="https://www.usa.gov/">USA.gov</a></div>
            </div>
            <div class="row-fluid">
                <div class="col-md-12 footer_copyright">? 2018 |United States Army Corp of Engineers. All Rights
                    Reserved.</div>
            </div>
        </section>

        <!-- PWA Service Worker -->
        <script>
            if (!navigator.serviceWorker.controller) {
                navigator.serviceWorker.register("./sw.js").then(function (reg) {
                    console.log("Service worker has been registered for scope: " + reg.scope);
                });
            }
        </script>
    </body>

</html>